---
tools:
  
    # Encode
    encoder:
      # input / sequence configuration
      - imesh: ${seq-prefix}${src-dir}/${src-mesh}
      - itex:  ${seq-prefix}${src-dir}/${src-tex}
      - fstart: ${first-frame}
      - fcount: ${num-frames}
      - gdepth: ${src-geom-bits}
      - tdepth: ${src-texcoord-bits}

      # Geometry decimate
      - qt: ${src-texcoord-bits}      
      - target: ${pp}
      - cctcount: 8

      # Texture parametrization
      - width:  $eval{ 1 << ${src-texcoord-bits} - 1 }
      - height: $eval{ 1 << ${src-texcoord-bits} - 1 }
      - quality: QUALITY
      - gutter: $eval{ 1 << (${src-texcoord-bits} - 8) }

      # Geometry parametrization
      # iteration count depends upon decimation level:
      - subdivIt: '$eval{ ${pp} < 0.09 ? 3 : ${pp} < 0.42 ? 2 : 0 }'

      - sdeform: 1
      - forceNormalDisp: 0
      - unifyVertices: 1
      - deformNormalThres: -2.0
      - deformNNCount: 1
      - deformFlipThres: -2.0
      - useInitialGeom: 1
      - smoothMotion: 0
      - smoothMethod: 1

      # For inter conditions w/o mapping, use fitsubdiv_inter threshold.
      # NB: does not apply when mapping is performed.
      # NB: the fitsubdiv_intra results are not always the same for ai and ld
      #     conditions due to the following (for soldier)
      - - !conditional 'defined ${fitsubdiv_with_mapping} and !${fitsubdiv_with_mapping}'
        - deformNormalThres: 0.8660254

      # common options
      - invorient: 0
      - tqp: 10
      - gofmax: 32
      # this was an error in the cfp submission.  The default is 1/3
      - dqb: 0.3333,0.3333333333333333,0.3333333333333333

      # don't normalize uv coordinates in locally decoded output
      - normuv: 0

      # the following defaults are overridden for some sequences and rates
      - unifvertices: 0
      - texwidth: 2048
      - texheight: 2048

      # colourspace conversion
      - cscencconfig: ${cfg-prefix}/hdrconvert/bgr444toyuv420.cfg
      - cscdecconfig: ${cfg-prefix}/hdrconvert/yuv420tobgr444.cfg

    # Decode
    decoder:
      - fstart:          ${first-frame}
      # Specifying the first output frame number helps align src/dec filenames      
      - cscdecconfig:    ${cfg-prefix}/hdrconvert/yuv420tobgr444.cfg
      # don't normalize uv coordinates in decoded output
      - normuv:          0            

    # Metric
    mmetric:
      - fstart:          ${first-frame}
      - fcount:          ${num-frames}
      - srcMesh:         ${seq-prefix}${src-dir}/${src-mesh}
      - srcTex:          ${seq-prefix}${src-dir}/${src-tex}
      - qp:              ${src-geom-bits}
      - qt:              ${src-texcoord-bits}
      - minPosition:     ${src-min-pos}
      - maxPosition:     ${src-max-pos}
      - pcc:             1
      - ibsm:            1
      - gridSize:        1024
